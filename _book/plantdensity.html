<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Work of R.Vezy for the ReMIX Project</title>
  <meta name="description" content="This book is made to keep track of my work during my post-doctorate position for the ReMIX project.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Work of R.Vezy for the ReMIX Project" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is made to keep track of my work during my post-doctorate position for the ReMIX project." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Work of R.Vezy for the ReMIX Project" />
  
  <meta name="twitter:description" content="This book is made to keep track of my work during my post-doctorate position for the ReMIX project." />
  

<meta name="author" content="R. Vezy">


<meta name="date" content="2018-06-18">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="eai.html">
<link rel="next" href="interrow-spacing.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Work of R.Vezy for the ReMIX project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="Light.html"><a href="Light.html"><i class="fa fa-check"></i><b>2</b> Light Interception</a><ul>
<li class="chapter" data-level="2.1" data-path="Light.html"><a href="Light.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="Light.html"><a href="Light.html#plant-shape"><i class="fa fa-check"></i><b>2.2</b> Plant shape</a><ul>
<li class="chapter" data-level="2.2.1" data-path="Light.html"><a href="Light.html#plant-width-computation"><i class="fa fa-check"></i><b>2.2.1</b> Plant width computation</a></li>
<li class="chapter" data-level="2.2.2" data-path="Light.html"><a href="Light.html#plant-width-correction"><i class="fa fa-check"></i><b>2.2.2</b> Plant width correction</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Light.html"><a href="Light.html#light-interception"><i class="fa fa-check"></i><b>2.3</b> Light interception</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Light.html"><a href="Light.html#incident-direct-radiation-from-the-atmosphere"><i class="fa fa-check"></i><b>2.3.1</b> Incident direct radiation from the atmosphere</a></li>
<li class="chapter" data-level="2.3.2" data-path="Light.html"><a href="Light.html#incident-diffuse-radiation-from-the-atmosphere"><i class="fa fa-check"></i><b>2.3.2</b> Incident diffuse radiation from the atmosphere</a></li>
<li class="chapter" data-level="2.3.3" data-path="Light.html"><a href="Light.html#total-diffuse-and-direct-radiation-from-the-atmosphere-incident-to-each-x-point"><i class="fa fa-check"></i><b>2.3.3</b> Total diffuse and direct radiation from the atmosphere incident to each X point</a></li>
<li class="chapter" data-level="2.3.4" data-path="Light.html"><a href="Light.html#light-tramsitted-by-the-dominant-crop-to-the-x-points"><i class="fa fa-check"></i><b>2.3.4</b> Light tramsitted by the dominant crop to the X points</a></li>
<li class="chapter" data-level="2.3.5" data-path="Light.html"><a href="Light.html#total-light-incident-to-x-points"><i class="fa fa-check"></i><b>2.3.5</b> Total light incident to X points</a></li>
<li class="chapter" data-level="2.3.6" data-path="Light.html"><a href="Light.html#total-radiation-incident-to-the-plane"><i class="fa fa-check"></i><b>2.3.6</b> Total radiation incident to the plane</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Light.html"><a href="Light.html#summary"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
<li class="chapter" data-level="2.5" data-path="Light.html"><a href="Light.html#discussion-and-proposed-modifications"><i class="fa fa-check"></i><b>2.5</b> Discussion and proposed modifications</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="trg.html"><a href="trg.html"><i class="fa fa-check"></i><b>3</b> Light incident to the dominated crop (trg)</a><ul>
<li class="chapter" data-level="3.1" data-path="trg.html"><a href="trg.html#computing-the-trg-incident-to-the-dominated-plant"><i class="fa fa-check"></i><b>3.1</b> Computing the trg incident to the dominated plant</a></li>
<li class="chapter" data-level="3.2" data-path="trg.html"><a href="trg.html#proposed-solution"><i class="fa fa-check"></i><b>3.2</b> Proposed solution</a></li>
<li class="chapter" data-level="3.3" data-path="trg.html"><a href="trg.html#results"><i class="fa fa-check"></i><b>3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eai.html"><a href="eai.html"><i class="fa fa-check"></i><b>4</b> Wheat EAI parameterization</a><ul>
<li class="chapter" data-level="4.1" data-path="eai.html"><a href="eai.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="eai.html"><a href="eai.html#model-sensitivity-to-the-p_sea-parameter"><i class="fa fa-check"></i><b>4.2</b> Model sensitivity to the <code>P_sea</code> parameter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plantdensity.html"><a href="plantdensity.html"><i class="fa fa-check"></i><b>5</b> Plant density and equivalent plant density</a><ul>
<li class="chapter" data-level="5.1" data-path="plantdensity.html"><a href="plantdensity.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plantdensity.html"><a href="plantdensity.html#the-density-effect-on-lai"><i class="fa fa-check"></i><b>5.2</b> The density effect on LAI</a></li>
<li class="chapter" data-level="5.3" data-path="plantdensity.html"><a href="plantdensity.html#the-equivalent-density"><i class="fa fa-check"></i><b>5.3</b> The equivalent density</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interrow-spacing.html"><a href="interrow-spacing.html"><i class="fa fa-check"></i><b>6</b> Interrow spacing</a><ul>
<li class="chapter" data-level="6.1" data-path="interrow-spacing.html"><a href="interrow-spacing.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="interrow-spacing.html"><a href="interrow-spacing.html#different-inter-row-spacing-for-mixed-crops"><i class="fa fa-check"></i><b>6.2</b> Different inter-row spacing for mixed crops</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Work of R.Vezy for the ReMIX Project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plantdensity" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Plant density and equivalent plant density</h1>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>The plant density, which is related to the interrow distance, seems to be an important formalism to describe the crop, and particularly for mixed crops. Several computations are made to represent plant competition in the STICS model, making the density effect a complex process. Lets describe each step of the process to have a clearer representation in mind.</p>
</div>
<div id="the-density-effect-on-lai" class="section level2">
<h2><span class="header-section-number">5.2</span> The density effect on LAI</h2>
<p>In the model, the plant density is taken as a negative effect upon the <code>LAI</code> growth as soon as a threshold of <code>LAI</code> is reached. This threshold (<code>P_laicomp</code>) represents the moment when the leaf surface of a plant start becoming competitive for light against another plant (from the same species or not). So whenever the <code>LAI</code> is higher than <code>P_laicomp</code>, the effect of the density (<code>efdensite</code>) become closer to 0 (the effect is null when equal to 1, and maximum at 0). This effect is computed as: <span class="math inline">\(ef_{densite}=\min\left\{1.0\ ;\ e^{P_{adens}\cdot\frac{log(densiteequiv)}{P_{bdens}}}\right\}\)</span> or more simply: <span class="math inline">\(ef_{densite}=\min\left\{1.0\ ;\ (\frac{densiteequiv}{P_{bdens}})^{P_{adens}}\right\}\)</span></p>
<blockquote>
<p>Replace the equation in the model to simplify too ?</p>
</blockquote>
<p>Here is a plot representing the density effect along the equivalent density:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">expand.grid</span>(<span class="dt">densiteequiv=</span> <span class="dv">140</span><span class="op">:</span><span class="dv">280</span>, <span class="dt">P_adens=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">0.54</span>,<span class="op">-</span><span class="fl">0.7</span>),<span class="dt">P_bdens=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">10</span>))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Parameters=</span> <span class="kw">paste</span>(<span class="st">&quot;P_adens=&quot;</span>,P_adens,<span class="st">&quot;P_bdens=&quot;</span>,P_bdens, <span class="dt">sep=</span><span class="st">&quot;, &quot;</span>),
            densiteequiv,
            <span class="dt">efdensite=</span> <span class="kw">pmin</span>(<span class="fl">1.0</span>,(<span class="kw">exp</span>(P_adens <span class="op">*</span><span class="st"> </span>(<span class="kw">log</span>(densiteequiv<span class="op">/</span>P_bdens))))))<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">arrange</span>(Parameters)<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>densiteequiv))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y=</span>efdensite,<span class="dt">colour=</span> Parameters))<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span> <span class="st">&quot;Equivalent density&quot;</span>, <span class="dt">y=</span> <span class="st">&quot;Density effect (0-1)&quot;</span>, <span class="dt">colour=</span> <span class="st">&quot;a and b parameters values&quot;</span>,
       <span class="dt">title=</span><span class="st">&quot;Equivalent density / density effect&quot;</span>)</code></pre></div>
<p><img src="Postdoc_steps_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>So the higher the density, the higher the negative effect on <code>LAI</code>.</p>
</div>
<div id="the-equivalent-density" class="section level2">
<h2><span class="header-section-number">5.3</span> The equivalent density</h2>
<p>In sole crops, the density effect is straightforward. However, under the case of mixed crops, the density effect can be higher for the dominated plant compared to its equivalent in sole crops. Indeed, a pea in sole crop would have a given competition with other close plants, but a different one when mixed with wheat, where the same density of wheat can give higher competition effect for light because it is taller.</p>
<p>Then the density effect is computed as an equivalent density instead (<code>densiteequiv</code>), that can differ from the sowing density for the dominated crop to increase the negative effect of <code>efdensite</code> compared to a sole crop.</p>
<p>The previous implementation in STICS was simple. The dominated plant had a doubled equivalent density compared to its actual density. After some discussion with the STICS intercrop team, Sebastian Munz modified the STICS code to implement a new formalism to define the equivalent density as a function of the height difference between the plants as follow:</p>
<p><span class="math inline">\(density_{Equivalent} =\begin{cases}\Delta_{height} &gt; hauteur_{threshold} &amp; density_{p2} + \frac{density_{p1}}{P_{bdensp1}}\cdot P_{bdensp2} \\ \Delta_{height} &lt; hauteur_{threshold} &amp; density_{p2}+slope\cdot abs\left|\Delta_{height}\right| \end{cases}\)</span></p>
<p>with <span class="math inline">\(diffx= \frac{density_{p1}}{P_{bdensp1}}\cdot P_{bdensp2}\)</span> and <span class="math inline">\(slope= \frac{diffx}{hauteur_{threshold}}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_DE=<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Delta_height=</span> <span class="kw">seq</span>(<span class="dt">from=</span> <span class="fl">0.01</span>, <span class="dt">to=</span> <span class="dv">1</span>, <span class="dt">by=</span> <span class="fl">0.01</span>))
density_p1=<span class="st"> </span><span class="dv">140</span>
density_p2=<span class="st"> </span><span class="dv">30</span>
P_bdensp1=<span class="st"> </span><span class="dv">7</span> ; P_bdensp2=<span class="st"> </span><span class="fl">1.5</span>
hauteur_threshold=<span class="st"> </span><span class="fl">0.2</span>
diffx =<span class="st"> </span>density_p1 <span class="op">/</span><span class="st"> </span>P_bdensp1 <span class="op">*</span><span class="st"> </span>P_bdensp2
slope=<span class="st"> </span>diffx<span class="op">/</span>hauteur_threshold</code></pre></div>
<p>Here is an exemple with a wheat-pea intercrop with a plant density of 140 for the wheat as the principal species and 30 for the pea as the associated species:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_DE<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Equ_density=</span> 
           <span class="kw">ifelse</span>(Delta_height<span class="op">&gt;</span>hauteur_threshold,
                  density_p2 <span class="op">+</span><span class="st"> </span>density_p1<span class="op">/</span>P_bdensp1 <span class="op">*</span>P_bdensp2,
                  density_p2<span class="op">+</span>slope<span class="op">*</span><span class="kw">abs</span>(Delta_height))
  )<span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y=</span> Equ_density, <span class="dt">x=</span> Delta_height, <span class="dt">colour=</span>Equ_density))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;Equivalent density&quot;</span>,
       <span class="dt">x =</span> <span class="st">&quot;Delta height (Dominant Plant Height-Dominated Plant Height)&quot;</span>,
       <span class="dt">y=</span> <span class="st">&quot;Dominated plant equivalent density&quot;</span>,
       <span class="dt">title=</span> <span class="st">&quot;New formalism for equivalent plant density&quot;</span>)</code></pre></div>
<p><img src="Postdoc_steps_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The new formalism has several implications in the model, notably that the dominated plant is less impacted by the competition with the dominant plant when both have approximately the same height.</p>
<p>A comparison of the two formalisms was made using the <a href="https://github.com/VEZY/sticRs">sticRs</a> package, from which a summary plot was extracted: <img src="img/Equ-dens-computation.png" alt="trg comparison" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="eai.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interrow-spacing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Postdoc_steps.pdf", "Postdoc_steps.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
