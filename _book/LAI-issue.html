<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>STICS intercrop: a work in progress for the ReMIX H2020 project</title>
  <meta name="description" content="This book is made to keep track of my work during my post-doctorate position for the ReMIX project.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="STICS intercrop: a work in progress for the ReMIX H2020 project" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is made to keep track of my work during my post-doctorate position for the ReMIX project." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="STICS intercrop: a work in progress for the ReMIX H2020 project" />
  
  <meta name="twitter:description" content="This book is made to keep track of my work during my post-doctorate position for the ReMIX project." />
  

<meta name="author" content="R. Vezy">


<meta name="date" content="2018-07-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="design.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/htmlwidgets-1.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STICS intercrop: a work in progress for the ReMIX H2020 project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="Light.html"><a href="Light.html"><i class="fa fa-check"></i><b>2</b> Light Interception</a><ul>
<li class="chapter" data-level="2.1" data-path="Light.html"><a href="Light.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="Light.html"><a href="Light.html#plant-shape"><i class="fa fa-check"></i><b>2.2</b> Plant shape</a><ul>
<li class="chapter" data-level="2.2.1" data-path="Light.html"><a href="Light.html#plant-width-computation"><i class="fa fa-check"></i><b>2.2.1</b> Plant width computation</a></li>
<li class="chapter" data-level="2.2.2" data-path="Light.html"><a href="Light.html#plant-width-correction"><i class="fa fa-check"></i><b>2.2.2</b> Plant width correction</a></li>
<li class="chapter" data-level="2.2.3" data-path="Light.html"><a href="Light.html#plant-height"><i class="fa fa-check"></i><b>2.2.3</b> Plant height</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Light.html"><a href="Light.html#light-interception"><i class="fa fa-check"></i><b>2.3</b> Light interception</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Light.html"><a href="Light.html#incident-direct-radiation-from-the-atmosphere"><i class="fa fa-check"></i><b>2.3.1</b> Incident direct radiation from the atmosphere</a></li>
<li class="chapter" data-level="2.3.2" data-path="Light.html"><a href="Light.html#incident-diffuse-radiation-from-the-atmosphere"><i class="fa fa-check"></i><b>2.3.2</b> Incident diffuse radiation from the atmosphere</a></li>
<li class="chapter" data-level="2.3.3" data-path="Light.html"><a href="Light.html#total-diffuse-and-direct-radiation-from-the-atmosphere-incident-to-each-x-point"><i class="fa fa-check"></i><b>2.3.3</b> Total diffuse and direct radiation from the atmosphere incident to each X point</a></li>
<li class="chapter" data-level="2.3.4" data-path="Light.html"><a href="Light.html#light-tramsitted-by-the-dominant-crop-to-the-x-points"><i class="fa fa-check"></i><b>2.3.4</b> Light tramsitted by the dominant crop to the X points</a></li>
<li class="chapter" data-level="2.3.5" data-path="Light.html"><a href="Light.html#total-light-incident-to-x-points"><i class="fa fa-check"></i><b>2.3.5</b> Total light incident to X points</a></li>
<li class="chapter" data-level="2.3.6" data-path="Light.html"><a href="Light.html#total-radiation-incident-to-the-plane"><i class="fa fa-check"></i><b>2.3.6</b> Total radiation incident to the plane</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Light.html"><a href="Light.html#summary"><i class="fa fa-check"></i><b>2.4</b> Summary</a></li>
<li class="chapter" data-level="2.5" data-path="Light.html"><a href="Light.html#discussion-and-proposed-modifications"><i class="fa fa-check"></i><b>2.5</b> Discussion and proposed modifications</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="trg.html"><a href="trg.html"><i class="fa fa-check"></i><b>3</b> Light incident to the dominated crop (trg)</a><ul>
<li class="chapter" data-level="3.1" data-path="trg.html"><a href="trg.html#computing-the-trg-incident-to-the-dominated-plant"><i class="fa fa-check"></i><b>3.1</b> Computing the trg incident to the dominated plant</a></li>
<li class="chapter" data-level="3.2" data-path="trg.html"><a href="trg.html#proposed-solution"><i class="fa fa-check"></i><b>3.2</b> Proposed solution</a></li>
<li class="chapter" data-level="3.3" data-path="trg.html"><a href="trg.html#results"><i class="fa fa-check"></i><b>3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="eai.html"><a href="eai.html"><i class="fa fa-check"></i><b>4</b> Wheat EAI parameterization</a><ul>
<li class="chapter" data-level="4.1" data-path="eai.html"><a href="eai.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="eai.html"><a href="eai.html#model-sensitivity-to-the-p_sea-parameter"><i class="fa fa-check"></i><b>4.2</b> Model sensitivity to the <code>P_sea</code> parameter</a></li>
<li class="chapter" data-level="4.3" data-path="eai.html"><a href="eai.html#parameterization-of-the-p_sea-parameter"><i class="fa fa-check"></i><b>4.3</b> Parameterization of the <code>P_sea</code> parameter</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plantdensity.html"><a href="plantdensity.html"><i class="fa fa-check"></i><b>5</b> Plant density and equivalent plant density</a><ul>
<li class="chapter" data-level="5.1" data-path="plantdensity.html"><a href="plantdensity.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="plantdensity.html"><a href="plantdensity.html#the-density-effect-on-lai"><i class="fa fa-check"></i><b>5.2</b> The density effect on LAI</a></li>
<li class="chapter" data-level="5.3" data-path="plantdensity.html"><a href="plantdensity.html#the-equivalent-density"><i class="fa fa-check"></i><b>5.3</b> The equivalent density</a></li>
<li class="chapter" data-level="5.4" data-path="plantdensity.html"><a href="plantdensity.html#proposition-for-a-newer-equivalent-density"><i class="fa fa-check"></i><b>5.4</b> Proposition for a newer equivalent density</a></li>
<li class="chapter" data-level="5.5" data-path="plantdensity.html"><a href="plantdensity.html#proposition-to-remove-the-old-explicit-interspecies-density-competition-effect"><i class="fa fa-check"></i><b>5.5</b> Proposition to remove the old explicit interspecies density competition effect</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="Interrow.html"><a href="Interrow.html"><i class="fa fa-check"></i><b>6</b> Interrow spacing</a><ul>
<li class="chapter" data-level="6.1" data-path="Interrow.html"><a href="Interrow.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="Interrow.html"><a href="Interrow.html#inter-row-spacing-for-mixed-crops-in-the-model"><i class="fa fa-check"></i><b>6.2</b> Inter-row spacing for mixed crops in the model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="design.html"><a href="design.html"><i class="fa fa-check"></i><b>7</b> Design</a><ul>
<li class="chapter" data-level="7.1" data-path="design.html"><a href="design.html#introduction-4"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="design.html"><a href="design.html#designs-that-can-be-simulated"><i class="fa fa-check"></i><b>7.2</b> Designs that can be simulated</a></li>
<li class="chapter" data-level="7.3" data-path="design.html"><a href="design.html#designs-that-cannot-be-simulated"><i class="fa fa-check"></i><b>7.3</b> Designs that cannot be simulated</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="LAI-issue.html"><a href="LAI-issue.html"><i class="fa fa-check"></i><b>8</b> Issue on LAI not decreasing</a><ul>
<li class="chapter" data-level="8.1" data-path="LAI-issue.html"><a href="LAI-issue.html#introduction-5"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="LAI-issue.html"><a href="LAI-issue.html#investigating-the-sla-hypothesis"><i class="fa fa-check"></i><b>8.2</b> Investigating the sla hypothesis</a></li>
<li class="chapter" data-level="8.3" data-path="LAI-issue.html"><a href="LAI-issue.html#leaf-senescence"><i class="fa fa-check"></i><b>8.3</b> Leaf senescence</a><ul>
<li class="chapter" data-level="8.3.1" data-path="LAI-issue.html"><a href="LAI-issue.html#leaf-lifespan"><i class="fa fa-check"></i><b>8.3.1</b> Leaf lifespan</a></li>
<li class="chapter" data-level="8.3.2" data-path="LAI-issue.html"><a href="LAI-issue.html#stress-indices"><i class="fa fa-check"></i><b>8.3.2</b> Stress indices</a></li>
<li class="chapter" data-level="8.3.3" data-path="LAI-issue.html"><a href="LAI-issue.html#over-fertilization"><i class="fa fa-check"></i><b>8.3.3</b> Over-fertilization</a></li>
<li class="chapter" data-level="8.3.4" data-path="LAI-issue.html"><a href="LAI-issue.html#de-activating-water-and-nitrogen-stresses"><i class="fa fa-check"></i><b>8.3.4</b> De-activating water and nitrogen stresses</a></li>
<li class="chapter" data-level="8.3.5" data-path="LAI-issue.html"><a href="LAI-issue.html#the-solution"><i class="fa fa-check"></i><b>8.3.5</b> The solution</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STICS intercrop: a work in progress for the ReMIX H2020 project</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="LAI_issue" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Issue on LAI not decreasing</h1>
<div id="introduction-5" class="section level2">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>The <code>LAI</code> is not decreasing on the end of the crop cycle for the dominant plant (Figure <a href="LAI-issue.html#fig:LAIhigh">8.1</a>).</p>
<div class="figure"><span id="fig:LAIhigh"></span>
<img src="img/LAI_high.png" alt="Leaf Area Index in a self-intercrop of Wheat-Wheat" />
<p class="caption">Figure 8.1: Leaf Area Index in a self-intercrop of Wheat-Wheat</p>
</div>
<p>This issue can have different origins. The main hypothesis are:</p>
<ul>
<li>The leaf surface may be too high compared to their mass, coming from an abnormally high <code>sla</code><br />
</li>
<li>A too low senescence, coming itself from a too long leaf lifespan, which could arise from a too low nitrogen mobilization (increase the lifespan), and/or a too low water stress (water stress can decrease the life span).</li>
</ul>
</div>
<div id="investigating-the-sla-hypothesis" class="section level2">
<h2><span class="header-section-number">8.2</span> Investigating the sla hypothesis</h2>
<p>Figure <a href="LAI-issue.html#fig:LAISLA">8.2</a> shows that both plants (<em>i.e.</em> Principal and Associated) have exactly the same <code>SLA</code> during the growing cycle. This discard the possibility of a problem coming from a wrong <code>SLA</code> because it would be much higher for the plant with the constant <code>LAI</code> at the end of the cycle.</p>
<div class="figure"><span id="fig:LAISLA"></span>
<img src="img/LAI_hyp_SLA.png" alt="Specific Leaf Area in a self-intercrop of Wheat-Wheat" />
<p class="caption">Figure 8.2: Specific Leaf Area in a self-intercrop of Wheat-Wheat</p>
</div>
</div>
<div id="leaf-senescence" class="section level2">
<h2><span class="header-section-number">8.3</span> Leaf senescence</h2>
<p>Leaf senescence is actually much lower for the plant that has a non-decreasing <code>LAI</code> (Figure <a href="LAI-issue.html#fig:Leafsen">8.3</a>)</p>
<div class="figure"><span id="fig:Leafsen"></span>
<img src="img/Senescence.png" alt="Leaf Senescence in a self-intercrop of Wheat-Wheat" />
<p class="caption">Figure 8.3: Leaf Senescence in a self-intercrop of Wheat-Wheat</p>
</div>
<p>The next step is to find out why leaf senescence is too low for this plant.</p>
<div id="leaf-lifespan" class="section level3">
<h3><span class="header-section-number">8.3.1</span> Leaf lifespan</h3>
<p>The Figure <a href="LAI-issue.html#fig:Durvie">8.4</a> shows that the leaf lifespan is not much different between both plants either, rejecting our hypothesis of a too long lifespan.</p>
<div class="figure"><span id="fig:Durvie"></span>
<img src="img/Durvie.png" alt="Leaf Lifespan in a self-intercrop of Wheat-Wheat" />
<p class="caption">Figure 8.4: Leaf Lifespan in a self-intercrop of Wheat-Wheat</p>
</div>
<p>However, printing the lifespan for each light environment (<em>i.e.</em> shaded, sunlit) showed that the lifespan of the shaded part of the dominated plant was equal to 0 most of the time, making <code>nsencours</code> jump from <code>nlev</code> to the first day when senescence is computed (here at day 208) at once (Figure <a href="LAI-issue.html#fig:nsencour">8.5</a>).</p>
<div class="figure"><span id="fig:nsencour"></span>
<img src="img/LAIhigh_nsencour.png" alt="Leaf (lai) appearence day (nsencour) compared to the day (day) they become senescent (self-intercrop of Wheat-Wheat)" />
<p class="caption">Figure 8.5: Leaf (lai) appearence day (<code>nsencour</code>) compared to the day (<code>day</code>) they become senescent (self-intercrop of Wheat-Wheat)</p>
</div>
<p>The leaf lifespan (<code>durvie(i)</code>) was computed as:</p>
<div class="sourceCode"><pre class="sourceCode fortran"><code class="sourceCode fortran"><span class="kw">if</span> (i <span class="op">&lt;</span> fin) <span class="kw">then</span>
  durvie(i) <span class="kw">=</span> <span class="bu">min</span>(durvie(i), durage <span class="kw">*</span> <span class="bu">min</span>(senstress, fstressgel))
<span class="kw">else</span>
  durvie(i) <span class="kw">=</span> durage <span class="kw">*</span> <span class="bu">min</span>(senstress, fstressgel)
<span class="kw">endif</span></code></pre></div>
<p>The bug came from the computation of <code>durvie(i)</code> that was initialized to 0, and always equal to 0 afterward until the <code>fin</code> was reached.<br />
A correction is proposed to fix the bug, which make the same computation except on the first day on which the senescence is computed (<code>nsencour==nlev</code>):</p>
<div class="sourceCode"><pre class="sourceCode fortran"><code class="sourceCode fortran"><span class="kw">if</span> (i <span class="op">&lt;</span> fin <span class="op">.and.</span> nsencour <span class="op">&gt;</span> nlev) <span class="kw">then</span>
  durvie(i) <span class="kw">=</span> <span class="bu">min</span>(durvie(i), durage <span class="kw">*</span> <span class="bu">min</span>(senstress, fstressgel))
<span class="kw">else</span>
  durvie(i) <span class="kw">=</span> durage <span class="kw">*</span> <span class="bu">min</span>(senstress, fstressgel)
<span class="kw">endif</span></code></pre></div>
<p>The new computation fix the bug, making <code>nsencour</code> more progressive as for the dominant plant (Figure <a href="LAI-issue.html#fig:nsencourfix">8.6</a>).</p>
<div class="figure"><span id="fig:nsencourfix"></span>
<img src="img/LAIhigh_nsencourfix.png" alt="Leaf (lai) appearence day (nsencour) compared to the day (day) they become senescent using the new computation of durvie (self-intercrop of Wheat-Wheat)" />
<p class="caption">Figure 8.6: Leaf (lai) appearence day (<code>nsencour</code>) compared to the day (<code>day</code>) they become senescent using the new computation of durvie (self-intercrop of Wheat-Wheat)</p>
</div>
</div>
<div id="stress-indices" class="section level3">
<h3><span class="header-section-number">8.3.2</span> Stress indices</h3>
<p>The senescence is computed using leaf life span, but also two different stress indices: <code>senfac</code> for the water stress and <code>innsenes</code> for the nitrogen stress. Figure <a href="LAI-issue.html#fig:senstress">8.7</a> shows that the plant with non-decreasing <code>LAI</code> has a higher stress compared with the other plant, rejecting again the hypothesis of a too low stress indices.</p>
<div class="figure"><span id="fig:senstress"></span>
<img src="img/sen_stress.png" alt="Stress index to compute leaf lifespan in a self-intercrop of Wheat-Wheat" />
<p class="caption">Figure 8.7: Stress index to compute leaf lifespan in a self-intercrop of Wheat-Wheat</p>
</div>
</div>
<div id="over-fertilization" class="section level3">
<h3><span class="header-section-number">8.3.3</span> Over-fertilization</h3>
<p>The problem could arise from a nitrogen over-fertilization (<code>inn</code>) that could increase lifespan, but the Figure <a href="LAI-issue.html#fig:overfert">8.8</a> shows the contrary, with a lower <code>inn</code> for the plant with non-decreasing <code>LAI</code>.</p>
<div class="figure"><span id="fig:overfert"></span>
<img src="img/overfert.png" alt="Nitrogen over-fertilization in a self-intercrop of Wheat-Wheat" />
<p class="caption">Figure 8.8: Nitrogen over-fertilization in a self-intercrop of Wheat-Wheat</p>
</div>
</div>
<div id="de-activating-water-and-nitrogen-stresses" class="section level3">
<h3><span class="header-section-number">8.3.4</span> De-activating water and nitrogen stresses</h3>
<p>To check if the senescence is still related to water and nitrogen stresses, Figure <a href="LAI-issue.html#fig:nostress">8.9</a> shows a simulation where both effects are removed (<code>P_codeh2oact= 2</code> and <code>P_codeinnact= 2</code>).</p>
<div class="figure"><span id="fig:nostress"></span>
<img src="img/nostress.png" alt="Simulation of a Wheat-Wheat self-intercrop with no nitrogen and water stresses" />
<p class="caption">Figure 8.9: Simulation of a Wheat-Wheat self-intercrop with no nitrogen and water stresses</p>
</div>
<p>Removing the stress do not change the fact that one plant has a constant <code>LAI</code> at the end of the crop cycle. This proves that the problem does not arise from a limitation in water or nitrogen.</p>
</div>
<div id="the-solution" class="section level3">
<h3><span class="header-section-number">8.3.5</span> The solution</h3>
<p>Three main variables were badly used to compute the senescence: <code>dltams</code>, <code>deltai</code> and <code>pfeuilverte</code>. These variables correspond to the daily increment in dry mass, daily increment in lai, and the green leaves proportion. The model used the values from previous computations kept in memory to compute the different components of the senescence for each light environment of the plant (<em>i.e.</em> sunlit or shaded) separately.</p>
<p>Unfortunately, the dominance of the plant can change over time, so a dominant plant with no shaded component can have one afterwards. If a dominant plant becomes dominated, the model was trying to use <code>dltams</code>, <code>deltai</code> and <code>pfeuilverte</code> of the shaded part of the plant that all were equal to 0 (as their initialization) because they were not computed before, making no senescence at all for the shaded part of the plant.</p>
<p>We propose to replace the use of a separated shaded and sunlit <code>dltams</code>, <code>deltai</code> and <code>pfeuilverte</code> by a their total at plant level, weighted by their relative surface under shaded and sunlit environment. For example, the <code>deltai</code> input to the <code>senescen</code> function would be <code>p(i)%deltai(0,1:sc%nbjmax)*p(i)%surf(ens)</code> instead of <code>p(i)%deltai(ens,1:sc%nbjmax))</code>, with <code>p(i)%deltai(0,n) = p(i)%deltai(sc%AS,n)* p(i)%surf(sc%AS) + p(i)%deltai(sc%AO,n)* p(i)%surf(sc%AO)</code>. This new computation has the advantage of considering all the lai that was incremented before, with a drawback being not to consider the previous relative surface of the plant.</p>
<p>Figure <a href="LAI-issue.html#fig:Newsen">8.10</a> shows the resulting outputs, which are more realistic</p>
<div class="figure"><span id="fig:Newsen"></span>
<img src="img/Newsen.png" alt="Simulation of a Wheat-Wheat self-intercrop leaf area index using the modified STICS version" />
<p class="caption">Figure 8.10: Simulation of a Wheat-Wheat self-intercrop leaf area index using the modified STICS version</p>
</div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="design.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["Postdoc_steps.pdf", "Postdoc_steps.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
